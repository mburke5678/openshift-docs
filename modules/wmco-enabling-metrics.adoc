// Module included in the following assemblies:
//
// * openshift_images/image-configuration.adoc
// * updating/updating_a_cluster/updating_disconnected_cluster/disconnected-update.adoc
// * windows_containers/enabling-windows-container-workloads.adoc

:_mod-docs-content-type: PROCEDURE
[id="wmco-enabling-metrics_{context}"]
= Enabling metrics for the Windows Machine Config Operator

You can configure the Windows Machine Config Operator (WMCO) to gather metrics that can be viewed in Prometheus. The WMCO creates a service monitor in the `kube-system` namespace, which exports data from the Windows exporter service.

// What data? WMCO, Windows nodes?

// Swiped this wording from elsewhere. Not sure if it works here:
// The following table describes this set of metrics. Some entries contain commands for getting specific logs. 

// Lists of available metrics?

.Procedure

* Edit the `openshift-windows-machine-config-operator` namespace to add `openshift.io/cluster-monitoring=true` label.
+
[source,yaml]
----
apiVersion: v1
kind: Namespace
metadata:
# ...
  labels:
    openshift.io/cluster-monitoring: "true" <1>
# ...
  name: openshift-windows-machine-config-operator
# ...
----
<1> Enables monitoring of the `openshift-windows-machine-config-operator` namespace.

.Verification

. Ensure that the `windows-exporter` service monitor was created in the `kube-system` namespace, by using the following command:
+
[source,yaml]
----
$ oc get servicemonitor kubelet-endpoint-monitor -n kube-system
----
+
.Example output
+
[source,yaml]
----
NAME               AGE
windows-exporter   5m
----

. Check that Prometheus can access the metrics:

.. From the web console, click *Observe* -> *Metrics*. 

.. Enter a PromQL query, select a time window to display, and click *Run Queries*.
